<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Running Node Modules from the Command Line &#8211; Justin Davis</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Being able to run a Node.js module from the command line, while also being able to include it and run it in your application, is a really useful pattern. Let's take a look at how to easily give your modules this super power.">
    <meta name="author" content="Justin Davis">
    <meta name="keywords" content="">
    <link rel="canonical" href="http://justindavis.co/2014/11/16/running-node-modules-from-the-command-line/">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/pixyll.css" type="text/css">

    <!-- Fonts -->
    <link href='//fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>
    
      <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    

    <!-- Open Graph -->
    <!-- From: https://github.com/mmistakes/hpstr-jekyll-theme/blob/master/_includes/head.html -->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Running Node Modules from the Command Line">
    <meta property="og:description" content="UX guy. Javascript hacker. Founder of Madera Labs and Drawer.">
    <meta property="og:url" content="http://justindavis.co/2014/11/16/running-node-modules-from-the-command-line/">
    <meta property="og:site_name" content="Justin Davis">
</head>

<body class="">
  <div class="site-wrap">
    <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <a href="http://justindavis.co" class="site-title">Justin Davis</a>
      <nav class="site-nav right">
        <a href="/about/">About</a>
<a href="/contact/">Contact</a>

      </nav>
      <div class="clearfix"></div>
      
        <div class="social-icons">
  <div class="left">
    
      <a class="fa fa-github" href="https://github.com/jwd2a"></a>
    
    <a class="fa fa-rss" href="/feed.xml"></a>
    
      <a class="fa fa-twitter" href="https://twitter.com/jwd2a"></a>
    
    
    
      <a class="fa fa-envelope" href="mailto:justin@maderalabs.com"></a>
    
    
      <a class="fa fa-linkedin" href="https://www.linkedin.com/in/jwd2a"></a>
    
  </div>
  <div class="right">
    
    
    
  </div>
</div>
<div class="clearfix"></div>

      
    </div>
  </div>
</header>


    <div class="post p2 p-responsive wrap" role="main">
      <div class="measure">
        


<div class="post-header mb2">
    <h1>Running Node Modules from the Command Line</h1>
    <span class="post-meta">Nov 16, 2014</span>
    <br> 
    <span class="post-meta small">2 minute read</span>
</div>

<article class="post-content">
  <div style="float:right">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      <!-- Blog Post -->
    <ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-9511660895620992" data-ad-slot="9517207742"></ins>
    <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </div>
  <p>Being able to run node.js modules from the command line is a really useful thing, especially if you’re building an app that runs on a server, and might occasionally need to have pieces of it invoked manually. </p>

<p>For example, let’s pretend you had an app that creates some kind of report, say, analytics for your site. You might have created a node module called <code>report.js</code> that runs the reports, given a type of report you pass into one of the methods. </p>

<p>Let’s assume that script looks something like this:</p>

<pre><code>
var reporter = {};
reporter.createReport = function(reportType){
    //your logic to create a report
}

module.exports = reporter;

</code></pre>

<p>This very simple module exports a method called <code>createReport</code>, which can be included in your application and called, like so:</p>

<pre><code>var reporter = require("./reporter");
reporter.createReport("site analytics");
</code></pre>

<p>But, what if you want to also be able to manually kick this off from the command line, in case someone asks you to run a report on the fly? Well, we can easily refactor our module to permit us to do just that. </p>

<p>Here’s our refactored module:</p>

<pre><code>#!/usr/bin/env node

(function(){
    var reporter = {};
    exports.createReport = reporter.createReport = function(reportType){
        //your logic to create a report
    });

    if (!module.parent) {
        reporter.createReport(process.argv[2]);
    }
})();
</code></pre>

<p>Let’s break down what we’ve done. </p>

<ol>
  <li>First, we’ve slightly modified how things are constructed on the object, choosing to assign our method to both the <code>exports</code> variable and to make it a method on <code>reporter</code>. </li>
  <li>Then, we’ve added logic that checks to see if this module has been required in by another script, and if not, runs our method with arguments from the command line as the arguments for the method. The <code>module.parent</code> call is a Node call that returns <code>true</code> if this module has been required by another file. By checking to see if the value is <code>false</code>, we’re telling our script that this wasn’t required by another file, and must have been executed as a stand alone file (such as from the command line).</li>
  <li>Finally, we wrap all of this in a self-invoking anonymous function, so our module logic runs immediately once the file is called.</li>
</ol>

<p>That’s it! Now, you can call this file as we did above where it was required into another file, or you can call it from the command line like this: <code>./reporter "site analytics"</code>.</p>

<p>Note that if you don’t include the shebang in the file, you’ll need to prepend your CLI call with <code>node</code>. </p>

<p>BOOM! Now your node modules can be included and invoked from another file, or simply run ala carte from the command line. I’ve found a lot of uses for this, and hope you do as well!</p>

</article>

 <div class="py2 post-footer">
  <img src="/images/avatar.jpg" alt="Justin Davis" class="avatar" />
  <p>
    Justin Davis is a hacker and user experience designer, and founder of <a href="http://www.maderalabs.com">Madera Labs</a> and <a href="http://www.getdrawer.com">Drawer</a>. He's an expert in UX, product design and product development. He's also pretty legit at throwing JavaScript around.
  </p>
  <p>
    Follow him on Twitter at <a href="http://www.twitter.com/jwd2a">@jwd2a</a>.
  </p>
  <p>
    Want to pick Justin's brain personally? <a href="http://letsdolunch.youcanbook.me">Buy him lunch</a> and he'll meet with you to chat about whatever you're working on.
  </p>
</div>
  
<div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'justindavis'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
 
<h3 class="related-post-title">Related Posts</h3> 
<div class="post ml2">
    <a href="/2014/12/07/my-first-open-source-contribution-node-amazon-products-api/" class="post-link">
        <h4 class="post-title">My First Open Source Contribution: Node Amazon Products API</h4>
        <p class="post-summary">For the first time, I've released an open source project, a Node.JS module that allows an easy way of interacting with the Amazon Product Advertising API. Available now on npm!</p>
    </a>
</div>

<div class="post ml2">
    <a href="/2014/12/01/buy-me-lunch/" class="post-link">
        <h4 class="post-title">Buy Me Lunch</h4>
        <p class="post-summary">Need help with UX, product design, development or anything else? Buy me lunch and let's chat.</p>
    </a>
</div>

<div class="post ml2">
    <a href="/2014/11/24/using-command-line-arguments-in-a-node-script/" class="post-link">
        <h4 class="post-title">Using Command Line Arguments in a Node Script</h4>
        <p class="post-summary">If you're creating scripts that can run on the command line, being able to pass arguments to the script is extremely useful. Let's take a look at how to do it with Node.</p>
    </a>
</div>

<div class="post ml2">
    <a href="/2014/11/24/just-ship/" class="post-link">
        <h4 class="post-title">Just Ship.</h4>
        <p class="post-summary">If you have an idea, something you want to build, stop making excuses and just do it.</p>
    </a>
</div>

<div class="post ml2">
    <a href="/2014/11/10/focusing-on-the-right-things/" class="post-link">
        <h4 class="post-title">Focusing on the Right Things</h4>
        <p class="post-summary">When you do a startup, you have a singular goal: getting people to use your stuff. Don't get distracted and miss the mark.</p>
    </a>
</div>

<div class="post ml2">
    <a href="/2014/11/01/review-asus-pb278q-lcd-monitor/" class="post-link">
        <h4 class="post-title">Review: Asus PB278 Dual Monitor Setup</h4>
        <p class="post-summary">Recently, I upgraded my monitors at home, to a pair of Asus PB278Qs. These ultra-HD monitors are absolutely gorgeous, and over half the price of Apple's Thunderbolt displays.</p>
    </a>
</div>

<div class="post ml2">
    <a href="/2014/10/30/determine-if-a-number-is-in-the-fibonacci-series-using-javascript/" class="post-link">
        <h4 class="post-title">Determine if a number is in the Fibonacci series using JavaScript</h4>
        <p class="post-summary">Given a certain value, how would you find out if that value is in the Fibonacci series, in the most memory-conservative way? Let's look at how to get this done using JavaScript.</p>
    </a>
</div>

<div class="post ml2">
    <a href="/2014/10/14/using-sass-with-titanium-alloy-style-sheets/" class="post-link">
        <h4 class="post-title">Using Sass with Titanium Alloy Style Sheets</h4>
        <p class="post-summary">If you're a Titanium dev, using Sass in your Alloy style sheets can save a bunch of time and make your code much more DRY. This post looks at how to get Sass up and running with Titanium.</p>
    </a>
</div>

<div class="post ml2">
    <a href="/2014/09/20/three-books-every-parent-to-be-must-read/" class="post-link">
        <h4 class="post-title">Three Books Every Parent-To-Be MUST READ</h4>
        <p class="post-summary">If you're a soon-to-be parent, do yourself and favor and pick up these three books. They made our lives infinitely easier, and our daughter much happier in those trying first few months</p>
    </a>
</div>

<div class="post ml2">
    <a href="/2014/09/17/the-new-app-store-yosemite-widgets/" class="post-link">
        <h4 class="post-title">The New App Store: Yosemite Widgets</h4>
        <p class="post-summary">With Apple's new OS, Yosemite, comes an entirely new class of apps: widgets. I have a feeling this might be the next big app store for devs to conquer</p>
    </a>
</div>
 

      </div>
    </div>
  </div>

  <footer class="footer">
  <div class="p2 wrap">
    <div class="measure mt1 center">
      <small>
        Thanks for reading. Don't steal my shit. 
      </small>
    </div>
  </div>
</footer>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-53680827-1', 'auto');
ga('send', 'pageview');

</script>


<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-51af5dfc0e30f577" async="async"></script>
</body>
</html>
